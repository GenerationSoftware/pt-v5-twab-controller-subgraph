type Vault @entity(immutable: true) {
    id: Bytes!
    accounts: [Account!]! @derivedFrom(field: "vault")
}

type User @entity {
    id: Bytes! # user's address
    accounts: [Account!]! @derivedFrom(field: "user")
}

type Account @entity {
    id: String! # vault address + user address
    vault: Vault!
    user: User!
    balance: BigInt! # balance in account
    delegateBalance: BigInt # amount of balance delegated to this account
    twabs: [Twab!]! @derivedFrom(field: "account")
    delegates: [Account!]! @derivedFrom(field: "delegatee") # accounts who delegated to this account
    delegatee: Account # account to whom this account delegates their balances
}

type Twab @entity {
    id: String! # account address + timestamp
    amount: BigInt!
    delegateBalance: BigInt!
    timestamp: BigInt!
    account: Account!
}
